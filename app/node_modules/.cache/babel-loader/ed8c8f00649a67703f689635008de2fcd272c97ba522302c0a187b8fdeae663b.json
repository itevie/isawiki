{"ast":null,"code":"var _jsxFileName = \"/home/isabella/Documents/projects/go/isawiki/app/src/dawn-ui/components/ContextMenuManager.tsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useRef, useState } from \"react\";\nimport Button from \"./Button\";\nimport Column from \"./Column\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport let showContextMenu = () => {};\nexport default function ContextMenuManager() {\n  _s();\n  const [contextMenu, setContextMenu] = useState(null);\n  const ref = useRef(null);\n  const [xy, setXy] = useState([0, 0]);\n  useEffect(() => {\n    document.addEventListener(\"click\", event => {\n      if (event.target instanceof HTMLInputElement) {\n        return;\n      }\n      setContextMenu(null);\n    });\n    showContextMenu = cm => {\n      // Check if it should be ignored\n      if (cm.ignoreClasses && cm.ignoreClasses.some(x => cm.event.target.matches(x))) return;\n      console.log(cm.ignoreClasses, cm.event.currentTarget);\n      cm.event.preventDefault();\n      setContextMenu(cm);\n\n      // Update the position of the context menu\n      setTimeout(() => {\n        var _ref$current;\n        let bounds = (_ref$current = ref.current) === null || _ref$current === void 0 ? void 0 : _ref$current.getBoundingClientRect();\n        if (!bounds) return;\n        let x = cm.event.pageX;\n        let y = cm.event.pageY;\n        if (x > window.innerWidth - bounds.width) x = window.innerWidth - bounds.width;\n        if (y > window.innerHeight - bounds.height) y = window.innerHeight - bounds.height;\n        setXy([x, y]);\n      }, 10);\n    };\n  }, []);\n  return contextMenu && /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: ref,\n    className: \"dawn-context-menu\",\n    style: {\n      left: `${xy[0]}px`,\n      top: `${xy[1]}px`\n    },\n    children: /*#__PURE__*/_jsxDEV(Column, {\n      util: [\"no-gap\"],\n      children: contextMenu.elements.map(e => e.type === \"button\" ? /*#__PURE__*/_jsxDEV(Button, {\n        onClick: ev => e.onClick(ev, cm => {\n          setTimeout(() => {\n            showContextMenu(cm);\n          }, 10);\n        }),\n        type: \"inherit\",\n        className: `dawn-context-menu-button dawn-context-menu-button-${e.scheme}`,\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          className: e.scheme && `dawn-color-${e.scheme}`,\n          children: e.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 15\n      }, this) : /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 15\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 7\n  }, this);\n}\n_s(ContextMenuManager, \"t+uo7qGYiraB8hr6OPFOM5tOsEs=\");\n_c = ContextMenuManager;\nvar _c;\n$RefreshReg$(_c, \"ContextMenuManager\");","map":{"version":3,"names":["useEffect","useRef","useState","Button","Column","jsxDEV","_jsxDEV","showContextMenu","ContextMenuManager","_s","contextMenu","setContextMenu","ref","xy","setXy","document","addEventListener","event","target","HTMLInputElement","cm","ignoreClasses","some","x","matches","console","log","currentTarget","preventDefault","setTimeout","_ref$current","bounds","current","getBoundingClientRect","pageX","y","pageY","window","innerWidth","width","innerHeight","height","className","style","left","top","children","util","elements","map","e","type","onClick","ev","scheme","label","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/isabella/Documents/projects/go/isawiki/app/src/dawn-ui/components/ContextMenuManager.tsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\nimport Button, { ButtonType } from \"./Button\";\nimport Column from \"./Column\";\n\nexport type ContextMenuEvent = React.MouseEvent<HTMLElement, MouseEvent>;\n\nexport interface ContextMenu {\n  event: ContextMenuEvent;\n  elements: ContextMenuItem[];\n  ignoreClasses?: string[];\n}\n\nexport interface ContextMenuItemBase {\n  type: \"button\" | \"seperator\";\n}\n\nexport interface ContextButtonItem extends ContextMenuItemBase {\n  type: \"button\";\n  label: string;\n\n  disabled?: boolean;\n  scheme?: ButtonType;\n\n  onClick: (\n    e: React.MouseEvent<HTMLButtonElement, MouseEvent>,\n    replaceWith: (cm: ContextMenu) => void\n  ) => void;\n}\n\nexport interface ContextSeperatorItem extends ContextMenuItemBase {\n  type: \"seperator\";\n}\n\nexport type ContextMenuItem = ContextButtonItem | ContextSeperatorItem;\n\nexport let showContextMenu: (cm: ContextMenu) => void = () => {};\n\nexport default function ContextMenuManager() {\n  const [contextMenu, setContextMenu] = useState<ContextMenu | null>(null);\n  const ref = useRef<HTMLDivElement>(null);\n  const [xy, setXy] = useState<[number, number]>([0, 0]);\n\n  useEffect(() => {\n    document.addEventListener(\"click\", (event) => {\n      if (event.target instanceof HTMLInputElement) {\n        return;\n      }\n      setContextMenu(null);\n    });\n\n    showContextMenu = (cm) => {\n      // Check if it should be ignored\n      if (\n        cm.ignoreClasses &&\n        cm.ignoreClasses.some((x) => (cm.event.target as Element).matches(x))\n      )\n        return;\n\n      console.log(cm.ignoreClasses, cm.event.currentTarget);\n\n      cm.event.preventDefault();\n      setContextMenu(cm);\n\n      // Update the position of the context menu\n      setTimeout(() => {\n        let bounds = ref.current?.getBoundingClientRect();\n        if (!bounds) return;\n\n        let x = cm.event.pageX;\n        let y = cm.event.pageY;\n\n        if (x > window.innerWidth - bounds.width)\n          x = window.innerWidth - bounds.width;\n\n        if (y > window.innerHeight - bounds.height)\n          y = window.innerHeight - bounds.height;\n\n        setXy([x, y]);\n      }, 10);\n    };\n  }, []);\n\n  return (\n    contextMenu && (\n      <div\n        ref={ref}\n        className=\"dawn-context-menu\"\n        style={{\n          left: `${xy[0]}px`,\n          top: `${xy[1]}px`,\n        }}\n      >\n        <Column util={[\"no-gap\"]}>\n          {contextMenu.elements.map((e) =>\n            e.type === \"button\" ? (\n              <Button\n                onClick={(ev) =>\n                  e.onClick(ev, (cm) => {\n                    setTimeout(() => {\n                      showContextMenu(cm);\n                    }, 10);\n                  })\n                }\n                type=\"inherit\"\n                className={`dawn-context-menu-button dawn-context-menu-button-${e.scheme}`}\n              >\n                <label className={e.scheme && `dawn-color-${e.scheme}`}>\n                  {e.label}\n                </label>\n              </Button>\n            ) : (\n              <hr />\n            )\n          )}\n        </Column>\n      </div>\n    )\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}